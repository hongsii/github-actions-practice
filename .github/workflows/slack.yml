name: slack-test
on:
  push:
    branches: master
    paths-ignore:
    - '**.md'
  deployment:

jobs:
  notify:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    - name: Run task
      run: |
        echo "This job should notify to slack"
        ls
    - uses: 8398a7/action-slack@v3
      if: always()
      with:
        status: ${{ job.status }}
        author_name: '배포 알리미'
        fields: repo,commit,message,action,ref,job,took
        custom_payload: |
          {
            username: '알림',
            icon_emoji: ':octocat:',
            blocks: [
            {
              type: "actions",
              elements: [
                {
                  type: "button",
                  text: {
                    type: "plain_text",
                    text: "Link Button"
                  },
                  url: "https://api.slack.com/block-kit"
                }
              ]
            }
            ]
          }
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # optional
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }} # required
